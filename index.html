<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>People can a Vote</title>
<link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet"/>
<style>
body{margin:0;font-family:Arial,sans-serif;background:#f4f6f8}
.wrap{max-width:1100px;margin:0 auto}
header{background:#fff;box-shadow:0 2px 4px rgba(0,0,0,.1);position:sticky;top:0}
.nav{display:flex;justify-content:space-between;align-items:center;padding:12px 16px}
.nav-left,.nav-right{display:flex;align-items:center;gap:10px}
button{padding:8px 12px;border-radius:10px;border:0;cursor:pointer}
button.ghost{background:#eee}
button.primary{background:#111;color:#fff}
.card{background:#fff;padding:16px;border-radius:12px;margin:16px}
#map{height:460px;border-radius:12px}
.screen{display:none}
.screen.active{display:block}
</style>
</head>
<body>

<header>
  <div class="wrap nav">
    <div class="nav-left">
      <strong>People can a Vote</strong>
      <button class="ghost" id="homeBtn">Home</button>
    </div>
    <div class="nav-right">
      <input id="search" placeholder="Search country or eventâ€¦">
      <span id="selectedCountryPill">Country: (all)</span>
      <span id="selectedContinentPill">Continent: All</span>
      <span id="authPill">Not signed in</span>
      <button class="ghost" id="openAuthBtn">Log in</button>
    </div>
  </div>
</header>

<div class="wrap" style="padding:6px 16px">
  <div id="continentsBar" style="display:flex;gap:8px;background:#fff;padding:8px;border-radius:12px">
    <button class="ghost" data-cont="ALL">All</button>
    <button class="ghost" data-cont="Europe">Europe</button>
    <button class="ghost" data-cont="Asia">Asia</button>
    <button class="ghost" data-cont="Africa">Africa</button>
    <button class="ghost" data-cont="North America">North America</button>
    <button class="ghost" data-cont="South America">South America</button>
    <button class="ghost" data-cont="Oceania">Oceania</button>
  </div>
</div>

<div class="wrap">
  <section id="screenHome" class="screen active">
    <div class="card"><h3>Map</h3><div id="map"></div></div>
  </section>
</div>

<script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>
<script src="https://unpkg.com/@supabase/supabase-js@2"></script>
<script>
const supabaseClient=supabase.createClient(
 "https://jqoomnhpyuikbntnrukw.supabase.co",
 "sb_publishable_SjZ_HQWN0XRE9ebbf_OwQg_kmJeS43h"
);
mapboxgl.accessToken="pk.eyJ1IjoiaGVyZ290dCIsImEiOiJjbWttdHQ3cmYwZ2hmM2pyMjd2bmk1c3ZmIn0.-9CViuw1h3-gy49EsKvFiQ";

let continentsById={},countries=[],selectedContinent="ALL";

document.getElementById("continentsBar").onclick=e=>{
 const b=e.target.closest("button[data-cont]");
 if(!b)return;
 selectedContinent=b.dataset.cont;
 document.getElementById("selectedContinentPill").textContent="Continent: "+selectedContinent;
};

async function loadContinents(){
 const {data}=await supabaseClient.from("continents").select("id,name");
 (data||[]).forEach(c=>continentsById[c.id]=c.name);
}
async function loadCountries(){
 const {data}=await supabaseClient.from("countries").select("code,name,continent_id");
 countries=(data||[]).map(c=>({...c,continent:continentsById[c.continent_id]}));
}

new mapboxgl.Map({
 container:"map",
 style:"mapbox://styles/mapbox/light-v11",
 center:[10,20],
 zoom:1.2
});

(async()=>{
 await loadContinents();
 await loadCountries();
})();
</script>

</body>
</html>
